The build process needs to create or otherwise attain the following files:
- `image.fit` created using `mkimage`
	- Linux `Image`
	- `.dtb`
	- `.its` FIT source file
- Raspberry Pi boot files (including `.elf`, `bootloader.bin`, etc.)
- `u-boot.env`
- `armstub8.bin` generated by TF-A
	- Raspberry Pi's `armstub8.bin`
	- `fip.bin`
		- OP-TEE `header.bin`, `pager.bin`, and `pageable.bin`
		- `u-boot.bin`
			- `.dtb` signed by U-Boot's `mkimage` tool

The current working scripts (as of [this](https://gitlab.tools.btcsp.co.uk/poc/cyberfirst-secure-verified-boot-2024/-/tree/06cbf655e155a113de54c006fedd51362b19fc03) commit) follow:
- Install dependencies
- Build all files specified by [[OP-TEE]]
- Generate a FIT file using [[U-Boot]]'s `mkimage` tool
- Update the disk image builder
- Rebuild [[OP-TEE]] with `EXT_DTB` specified
- Flash the completed output image to the SD card

## Bottleneck

Depending on the selected configuration for U-Boot's `.dtb` (`CONFIG_OF_EMBED` or `CONFIG_OF_SEPARATE`), the signed `.dtb` may be required prior to the compilation of U-Boot, which is not currently possible without having first build everything to allow creation of the FIT file. Using `CONFIG_OF_SEPARATE` should allow the appending of the signed `.dtb` to `u-boot-nodtb.bin` (the U-Boot binary generated without an included `.dtb`) without requiring re-compilation.
`CONFIG_OF_BOARD` would be optimal for our use case as the Raspberry Pi boot loader run by the SoC (system on a chip) pre-loads the `.dtb` at `bcm2710-rpi-3-b-plus.dtb` in the `root` partition even before [[TF-A]], and is in fact the `.dtb` [[TF-A]] uses.
An independent source of a correct `armstub8.bin` would make the first compile unnecessary, as the FIT file could be the first thing generated, providing the signed DTB.`

## DTB

As most of the stages all require, and thus try to supply, their own DTB's, it is necessary to make absolutely sure that the desired DTB is being used at each stage. [[TF-A]] and [[OP-TEE]] both use the DTB loaded by the SoC, which must be placed in the `root` partition and named `bcm2710-rpi-3-b-plus.dtb`, while [[U-Boot]] may get its DTB from a variety of sources, see [[U-Boot#^dtb-srcs]] for more details.
